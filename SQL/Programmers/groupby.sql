# ì§„ë£Œê³¼ë³„ ì´ ì˜ˆì•½ íšŸìˆ˜ ì¶œë ¥
SELECT MCDP_CD AS 'ì§„ë£Œê³¼ì½”ë“œ', COUNT(APNT_NO) as '5ì›”ì˜ˆì•½ê±´ìˆ˜'
FROM APPOINTMENT
WHERE DATE_FORMAT(APNT_YMD, '%Y%m')='202205' 
GROUP BY 1
ORDER BY 2, 1 

# ê³ ì–‘ì´ì™€ ê°œ ëª‡ ë§ˆë¦¬?
SELECT ANIMAL_TYPE, COUNT(ANIMAL_ID)
FROM ANIMAL_INS
GROUP BY 1
ORDER BY 1

# ì„±ë¶„ìœ¼ë¡œ êµ¬ë¶„í•œ ì•„ì´ìŠ¤í¬ë¦¼ ì´ ì£¼ë¬¸ëŸ‰
SELECT INGREDIENT_TYPE, SUM(TOTAL_ORDER)
FROM FIRST_HALF FH
JOIN ICECREAM_INFO II ON FH.FLAVOR = II.FLAVOR
GROUP BY 1

# ë™ëª… ë™ë¬¼ ìˆ˜ ì°¾ê¸°
SELECT NAME, COUNT(*) AS 'COUNT'
FROM ANIMAL_INS
WHERE NAME IS NOT NULL
GROUP BY NAME
HAVING COUNT >= 2
ORDER BY NAME

# ìž…ì–‘ ì‹œê° êµ¬í•˜ê¸°(1)
SELECT HOUR(DATETIME) AS HOUR, COUNT(*) AS COUNT
FROM ANIMAL_OUTS
GROUP BY 1
HAVING HOUR >= 9 AND HOUR < 20
ORDER BY 1

# ê°€ê²©ëŒ€ ë³„ ìƒí’ˆ ê°œìˆ˜ êµ¬í•˜ê¸°
SELECT TRUNCATE(PRICE, -4) AS PRICE_GROUP -- BETWEENì´ ì•„ë‹Œ TRUNCATEë¡œ ê°„ë‹¨í•˜ê²Œ ë²”ìœ„ ì„¤ì •í•´ ë²„ë¦¬ê¸°..
     , COUNT(*) AS PRODUCTS 
FROM PRODUCT
GROUP BY 1
ORDER BY 1

# ì¹´í…Œê³ ë¦¬ ë³„ ë„ì„œ íŒë§¤ëŸ‰ ì§‘ê³„
SELECT CATEGORY, SUM(SALES) AS TOTAL_SALES
FROM BOOK B
JOIN BOOK_SALES BS ON B.BOOK_ID = BS.BOOK_ID
WHERE SALES_DATE LIKE '2022-01%'
-- WHERE DATE_FORMAT(SALES_DATE, '%Y%m') = '202201'
GROUP BY 1
ORDER BY 1

# ì¦ê²¨ì°¾ê¸° ë§Žì€ ì‹ë‹¹~
-- # SELECT FOOD_TYPE, REST_ID, REST_NAME, MAX(FAVORITES) AS FAVORITES
-- # FROM REST_INFO 
-- # GROUP BY 1
-- # ORDER BY 1 DESC

SELECT B.FOOD_TYPE, A.REST_ID, A.REST_NAME, B.FAVORITES
FROM REST_INFO A
JOIN (SELECT FOOD_TYPE, MAX(FAVORITES) AS FAVORITES
      FROM REST_INFO
      GROUP BY 1) B
      ON A.FOOD_TYPE = B.FOOD_TYPE
      AND A.FAVORITES = B.FAVORITES
GROUP BY 1
ORDER BY 1 DESC

-- # SELECT FOOD_TYPE, MAX(FAVORITES) AS FAVORITES
-- # FROM REST_INFO
-- # GROUP BY FOOD_TYPE

# ìž…ì–‘ ì‹œê° êµ¬í•˜ê¸° 2
SET @HOUR = -1;
SELECT @HOUR := @HOUR+1 AS HOUR, (SELECT COUNT(*) 
                                  FROM ANIMAL_OUTS 
                                  WHERE HOUR(DATETIME) = @HOUR) AS COUNT
FROM ANIMAL_OUTS
WHERE @HOUR < 23
GROUP BY 1
ORDER BY 1
-- ì„œë¸Œì¿¼ë¦¬ì™€ SET í•¨ìˆ˜ ì‚¬ìš©!

# ì €ìž ë³„ ì¹´í…Œê³ ë¦¬ ë³„ ë§¤ì¶œì•¡ ì§‘ê³„í•˜ê¸°
SELECT B.AUTHOR_ID, AUTHOR_NAME, CATEGORY, SUM(PRICE*SALES) AS TOTAL_SALES
FROM BOOK AS B
JOIN AUTHOR A ON A.AUTHOR_ID = B.AUTHOR_ID
JOIN BOOK_SALES BS ON BS.BOOK_ID = B.BOOK_ID
WHERE SALES_DATE LIKE '2022-01%'
GROUP BY 2,3
ORDER BY 1, 3 DESC

# ì‹í’ˆ ë¶„ë¥˜ë³„ ê°€ìž¥ ë¹„ì‹¼ ì‹í’ˆì˜ ì •ë³´ ì¡°íšŒí•˜ê¸° ðŸ¤·â€â™‚ï¸ðŸ¤·â€â™‚ï¸ðŸ¤·â€â™‚ï¸ðŸ¤·â€â™‚ï¸
SELECT CATEGORY, PRICE AS MAX_PRICE, PRODUCT_NAME
FROM FOOD_PRODUCT 
WHERE PRICE IN (SELECT MAX(PRICE) 
                FROM FOOD_PRODUCT 
                GROUP BY CATEGORY)
            AND CATEGORY IN ('ê³¼ìž', 'êµ­', 'ê¹€ì¹˜', 'ì‹ìš©ìœ ')
ORDER BY 2 DESC